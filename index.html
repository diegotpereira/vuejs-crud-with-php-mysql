<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Bootstrap CSS -->
    <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap/dist/css/bootstrap.min.css" />

    <!-- BootstrapVue CSS-->
    <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css">

    <!-- Bootstrap npm CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Vuejs -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <!-- BootstrapVue js -->
    <script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js"></script>

    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Bootstrap js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


</head>

<body>
    <div class="container" id="livroApp">
        <!-- Content -->
        <div class="card-header">
            <div class="d-flex d-flex justify-content-between">
                <div class="lead"><button id="show-btn" @click="showModal('add-modal')" class="btn btn-sm btn-outline-primary">Novo Registro</button></div>
            </div>
        </div>

        <div class="card-body">
            <!-- adicionar início modal de registro de livro -->
            <b-modal ref="add-modal" hide-footer title="Adicionar Novo Registro">
                <form action="" @submit.prevent="onSubmit">
                    <div class="form-group">
                        <label for="">Nome do Livro</label>
                        <input type="text" name="" id="" v-model="nome" class="form-control">
                    </div>
                    <br/>
                    <div class="form-group">
                        <label for="">Autor</label>
                        <input type="text" v-model="autor" class="form-control">
                    </div>
                    <br/>
                    <div class="form-group">
                        <button class="btn btn-sm btn-outline-success">Adicionar Registro</button> &nbsp;
                        <b-button class="btn btn-sm btn-outline-danger" variant="outline-danger" block @click="hideModal('add-modal')">Fechar

                        </b-button>
                    </div>
                </form>
            </b-modal>
            <!--Final Modal Adicionar Livro-->
        </div>
    </div>
</body>
<script>
    var application = new Vue({
        el: '#livroApp',
        data: {
            nome: '',
            autor: '',
            todosRegistros: [],
            atualizar_id: '',
            atualizar_nome: '',
            atualizar_autor: '',
            sucessoMsg: ''
        },

        methods: {
            showModal(id) {
                this.$refs[id].show()
            },
            hideModal(id) {
                this.$refs[id].hide()
            },
            onSubmit() {
                if (this.nome !== '' && this.autor !== '') {
                    var fd = new FormData()

                    fd.append('nome', this.nome)
                    fd.append('autor', this.autor)

                    axios({
                            url: 'criar.php',
                            method: 'POST',
                            data: fd
                        })
                        .then(response => {
                            if (response.data.result == 'success') {
                                application.sucessoMsg = "Registro inserido com sucesso..!";
                                this.nome = '',
                                    this.autor = ''

                                application.hideModal('add-modal')
                                application.buscarRegistros()
                            } else {
                                alert('erro! Houve um erro ao inserir registro..!')
                            }
                        })
                        .catch(error => {
                            console.log(error)
                        })
                } else {
                    alert('desculpe! todos os campos são necessários preencher..!')
                }
            },
            buscarRegistros() {

            },
            deletarRegistro() {

            },
            editarRegistro() {

            },
            onUpdate() {

            },
            mounted: function() {
                this.buscarRegistros()
            }
        }
    });
</script>

<!-- <script src="https://code.jquery.com/jquery-3.0.0.min.js"></script> -->

</html>